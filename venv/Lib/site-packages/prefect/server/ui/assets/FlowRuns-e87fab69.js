import{d as j,_ as G,R as J,g as f,M as b,f as r,$ as P,a0 as q,a1 as K,a2 as W,a3 as X,p as m,i as p,c as n,j as c,o as s,n as a,u as e,a4 as Y,m as C,O as ee,A as V,a5 as se,a6 as te,a as d,Q as _,a7 as oe,a8 as le,a9 as ne,aa as ae,ab as ue,ac as re,ad as ce,ae as de,G as ie,t as fe,af as me}from"./index-ac1bd61a.js";import{u as pe}from"./usePageTitle-4ac27103.js";const _e={class:"flow-runs__list"},we={class:"flow-runs__list-controls--right"},F=3e4,ye=j({__name:"FlowRuns",setup(Re){const h=G(),w=J(),R=f(),v=b(w.flowRuns.getFlowRunsCount,[{}]),N=r(()=>v.executed),x=r(()=>v.response===0),i=f(),B=P(i,1200),{filter:t,isCustomFilter:S}=q({flowRuns:{nameLike:B}}),k=r({get(){return t.flowRuns.parentTaskRunIdNull},set(g){t.flowRuns.parentTaskRunIdNull=g?!0:void 0}}),T=b(w.ui.getFlowRunHistory,[t],{interval:F}),H=r(()=>T.response??[]),{flowRuns:y,total:M,subscriptions:U,next:A}=K(t,{mode:"infinite",interval:F}),u=f([]),{margin:I}=W(),L=()=>({rootMargin:I.value}),{stuck:O}=X(R,L),$=r(()=>({listControls:{"flow-runs__list-controls--stuck":O.value&&m.md}}));function z(){h.push(me.flowRuns())}const D=()=>{u.value=[],U.refresh()};return pe("Flow Runs"),(g,o)=>{const E=p("p-toggle"),Q=p("p-button"),Z=p("p-layout-default");return s(),n(Z,{class:"flow-runs"},{header:c(()=>[a(e(Y))]),default:c(()=>[N.value?(s(),C(V,{key:0},[x.value?(s(),n(e(ee),{key:0})):(s(),C(V,{key:1},[a(e(se)),e(m).md?(s(),n(e(te),{key:0,history:H.value,"start-date":e(t).flowRuns.expectedStartTimeAfter,"end-date":e(t).flowRuns.expectedStartTimeBefore,class:"flow-runs__chart"},null,8,["history","start-date","end-date"])):d("",!0),_("div",_e,[_("div",{ref_key:"listControls",ref:R,class:oe(["flow-runs__list-controls",$.value.listControls])},[_("div",we,[u.value.length==0?(s(),n(e(le),{key:0,count:e(M),label:"Flow run"},null,8,["count"])):(s(),n(e(ne),{key:1,count:u.value.length},null,8,["count"])),a(e(ae),{selected:u.value,onDelete:D},null,8,["selected"])]),a(E,{modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=l=>k.value=l),class:"flow-runs__subflows-toggle",append:"Hide subflows"},null,8,["modelValue"]),e(m).md?(s(),n(e(ue),{key:0,modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=l=>i.value=l),placeholder:"Search by run name",label:"Search by run name"},null,8,["modelValue"])):d("",!0),a(e(re),{modelValue:e(t).sort,"onUpdate:modelValue":o[2]||(o[2]=l=>e(t).sort=l),class:"flow-runs__sort"},null,8,["modelValue"])],2),a(e(ce),{selected:u.value,"onUpdate:selected":o[3]||(o[3]=l=>u.value=l),selectable:"","flow-runs":e(y),onBottom:e(A)},null,8,["selected","flow-runs","onBottom"]),e(y).length?d("",!0):(s(),n(e(de),{key:0},ie({_:2},[e(S)?{name:"actions",fn:c(()=>[a(Q,{small:"",onClick:z},{default:c(()=>[fe(" Clear Filters ")]),_:1})]),key:"0"}:void 0]),1024))])],64))],64)):d("",!0)]),_:1})}}});export{ye as default};
